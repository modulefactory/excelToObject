<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="iceberg.capi.order.smtcdb.repository.returnexchange.RtpSelItemSqlMapRepository">

	<resultMap id="rtpExchPrdMap" type="iceberg.capi.order.model.returnexchange.RtpExchPrd">
		<result property="ordNo"                  column="ORD_NO"/>
		<result property="ordDtm"                 column="ORD_DTM"/>
		<result property="ordItemNo"              column="ORD_ITEM_NO"/>
		<result property="prdCd"                  column="PRD_CD"/>
		<result property="exposPrdNm"             column="EXPOS_PRD_NM"/>
		<result property="ordQty"                 column="ORD_QTY"/>
		<result property="ordItemStCd"            column="ORD_ITEM_ST_CD"/>
		<result property="rtpQty"                 column="RTP_QTY"/>
		<result property="chanlCd"                column="CHANL_CD"/>
		<result property="ordTypDtlCd"            column="ORD_TYP_DTL_CD"/>
		<result property="rtpExchPsblFlg"         column="RTP_EXCH_PSBL_FLG"/>
		<result property="supCd"                  column="SUP_CD"/>
		<result property="dlvcStdAmt"             column="DLVC_STD_AMT"/>
		<result property="dlvPickMthodCd"         column="DLV_PICK_MTHOD_CD"/>
		<result property="mimTypCd"               column="MIM_TYP_CD"/>
		<result property="supNm"                  column="SUP_NM"/>
		<result property="asignrTelno"            column="ASIGNR_TELNO"/>
		<result property="rfnTypCd"               column="RFN_TYP_CD"/>
		<result property="salePrc"                column="SALE_PRC"/>
		<result property="payPrc"                 column="PAY_PRC"/>
		<result property="arfnTimeCd"             column="ARFN_TIME_CD"/>
		<result property="attrPrdCd"              column="ATTR_PRD_CD"/>
		<result property="srAcpFlg"               column="SR_ACP_FLG"/>
		<result property="rtpReReqPrevntCd"       column="RTP_RE_REQ_PREVNT_CD"/>
		<result property="rtpPsblDt"              column="RTP_PSBL_DT"/>
		<result property="repPrdSupPrdCd"         column="REP_PRD_SUP_PRD_CD"/>
		<result property="oboxCd"                 column="OBOX_CD"/>
		<result property="rtpCostAmt"             column="RTP_COST_AMT"/>
		<result property="exchCostAmt"            column="EXCH_COST_AMT"/>
		<result property="apntDlvsImplmFlg"       column="APNT_DLVS_IMPLM_FLG"/>
		<result property="dlvFshDt"               column="DLV_FSH_DT"/>
		<result property="cvsDlvsRtpFlg"          column="CVS_DLVS_RTP_FLG"/>
		<result property="optPrdTypCd"            column="OPT_PRD_TYP_CD"/>
		<result property="ecAttrSeq"              column="EC_ATTR_SEQ"/>
		<result property="dittoFlg"               column="DITTO_FLG"/>
		<result property="bundlDlvCd"             column="BUNDL_DLV_CD"/>
		<result property="frmlesPrdTypCd"         column="FRMLES_PRD_TYP_CD"/>
		<result property="charCpnRcvrTelno"       column="CHAR_CPN_RCVR_TELNO"/>
		<result property="lineTypCd"              column="LINE_TYP_CD"/>
		<result property="lineTypNm"              column="LINE_TYP_NM"/>
		<result property="ordItemId"              column="ORD_ITEM_ID"/>
		<result property="orgOrdNo"               column="ORG_ORD_NO"/>
		<result property="orgOrdItemId"           column="ORG_ORD_ITEM_ID"/>
	</resultMap>
	
	<resultMap id="simpleGftInfoMap" type="iceberg.capi.order.model.returnexchange.SimpleGftInfo">
		<result property="ordItemId"        column="ORD_ITEM_ID"        />
		<result property="ordNo"            column="ORD_NO"             />
		<result property="ordItemNo"        column="ORD_ITEM_NO"        />
		<result property="prdCd"            column="PRD_CD"             />
		<result property="prdNm"            column="PRD_NM"             />
		<result property="ordQty"           column="ORD_QTY"            />
		<result property="orgOrdItemId"     column="ORG_ORD_ITEM_ID"    />
		<result property="lineTypCd"        column="LINE_TYP_CD"        />
		<result property="stCd"             column="ST_CD"              />
		<result property="optPrdTypCd"      column="OPT_PRD_TYP_CD"     />
		<result property="attrGftYn"        column="ATTR_GFT_YN"        />
		<result property="multiSimplGbnCd"  column="MULTI_SIMPL_GBN_CD" />
		<result property="wthdrwYn"         column="WTHDRW_YN"          />
	</resultMap>
	
	<!--
	   	내용 : 반품/교환 상품 조회
	   	작성자 : 박노정
	   	작성일 : 2013. 11. 14
	   
	   	#{custNo} = 40766020
	   	#{ordNo} = 599917571
	   	#{ordItemNo} = 1
	   	#{supCd} = 120295
	   	#{rfnTypCd} = '10'
	-->
	
	<select id="findRtpPrdList" parameterType="criteria" resultMap="rtpExchPrdMap">
		SELECT ORD_NO
		     , ORD_DTM
		     , ORD_ITEM_NO
		     , PRD_CD
		     , EXPOS_PRD_NM
		     , ORD_QTY
		     , ORD_ITEM_ST_CD
		     , RTP_QTY
		     , CHANL_CD
		     , ORD_TYP_DTL_CD
		     , RTP_EXCH_PSBL_FLG
		     , SUP_CD
		     , DLVC_STD_AMT
		     , DLV_PICK_MTHOD_CD
		     , MIM_TYP_CD
		     , SUP_NM
		     , ASIGNR_TELNO
		     , RFN_TYP_CD
		     , SALE_PRC
		     , PAY_PRC
		     , ARFN_TIME_CD
		     , ATTR_PRD_CD
		     , SR_ACP_FLG
		     , RTP_RE_REQ_PREVNT_CD
		     , RTP_PSBL_DT
		     , REP_PRD_SUP_PRD_CD
		     , OBOX_CD
		     , CASE
		         WHEN EXCH_RTP_CHR_YN = 'Y' AND RTP_DLVC_CD <![CDATA[<>]]> '0'
		         THEN
		           (SELECT NVL(DLVC_AMT, 0) * X.RTP_ONEWY_RNDTRP_CD
		              FROM SUP_DLVC_D
		             WHERE DLVC_CD = X.RTP_DLVC_CD
		           )
		         WHEN EXCH_RTP_CHR_YN = 'Y' AND RTP_DLVC_CD = '0'
		         THEN
		           CASE
		             WHEN APNT_DLVS_IMPLM_FLG = 'Y' AND APNT_DLVS_DLVC_CD <![CDATA[<>]]> '0'
		             THEN
		               (SELECT NVL(DLVC_AMT, 0) * X.RTP_ONEWY_RNDTRP_CD
		                  FROM SUP_DLVC_D
		                 WHERE DLVC_CD = X.APNT_DLVS_DLVC_CD
		               )
		             WHEN APNT_DLVS_IMPLM_FLG = 'N' AND CHR_DLVC_CD <![CDATA[<>]]> '0'
		             THEN
		               (SELECT NVL(DLVC_AMT, 0) * X.RTP_ONEWY_RNDTRP_CD
		                  FROM SUP_DLVC_D
		                 WHERE DLVC_CD = X.APNT_DLVS_DLVC_CD
		               )
		             ELSE 0
		           END
		         ELSE 0
		       END AS RTP_COST_AMT
		     , CASE
		         WHEN EXCH_RTP_CHR_YN = 'Y' AND RTP_DLVC_CD <![CDATA[<>]]> '0'
		         THEN
		           (SELECT NVL(DLVC_AMT, 0) * X.EXCH_ONEWY_RNDTRP_CD
		              FROM SUP_DLVC_D
		             WHERE DLVC_CD = X.RTP_DLVC_CD
		           )
		         WHEN EXCH_RTP_CHR_YN = 'Y' AND RTP_DLVC_CD = '0'
		         THEN
		           CASE
		             WHEN APNT_DLVS_PICK_TYP_CD = 'B' AND APNT_DLVS_IMPLM_FLG = 'Y' AND APNT_DLVS_DLVC_CD <![CDATA[<>]]> '0'
		             THEN
		               (SELECT NVL(DLVC_AMT, 0) * X.EXCH_ONEWY_RNDTRP_CD
		                  FROM SUP_DLVC_D
		                 WHERE DLVC_CD = X.APNT_DLVS_DLVC_CD
		               )
		             WHEN APNT_DLVS_PICK_TYP_CD <![CDATA[<>]]> 'B' AND APNT_DLVS_IMPLM_FLG = 'N' AND CHR_DLVC_CD <![CDATA[<>]]> '0'
		             THEN
		               (SELECT NVL(SALE_PRC, 0) * X.EXCH_ONEWY_RNDTRP_CD
		                  FROM PRD_PRC_H
		                 WHERE PRD_CD = X.CHR_DLVC_CD AND SYSDATE BETWEEN VALID_STR_DTM AND VALID_END_DTM AND PRD_ATTR_GBN_CD =
		                 'P'
		               )
		             ELSE 0
		           END
		         ELSE 0
		       END AS EXCH_COST_AMT
		     , APNT_DLVS_IMPLM_FLG
		     , DLV_FSH_DT
		     , CVS_DLVS_RTP_FLG
		     , OPT_PRD_TYP_CD
		     , EC_ATTR_SEQ
		     , DITTO_FLG
		     , BUNDL_DLV_CD
		     , FRMLES_PRD_TYP_CD
		     , CHAR_CPN_RCVR_TELNO
		     , LINE_TYP_CD
		     , (SELECT CD_VAL
		          FROM CMM_CMM_C
		         WHERE CMM_GRP_CD = 'ORD032'
		         AND CMM_CD       = LINE_TYP_CD
		       ) AS LINE_TYP_NM
		     , ORD_ITEM_ID
		     , ORG_ORD_NO
		     , NVL(ORG_ORD_ITEM_ID, ORD_ITEM_ID) AS ORG_ORD_ITEM_ID
		  FROM
		       (SELECT OOM.ORD_NO
		             , OOM.ORD_DTM
		             , OID.ORD_ITEM_NO
		             , OID.LINE_TYP_CD
		             , PPM.PRD_CD                                                        AS PRD_CD
		             , OID.EXPOS_PRD_NM                                                  AS EXPOS_PRD_NM
		             , NVL(OID.ORD_QTY, 0)                                               AS ORD_QTY
		             , CASE
		                 WHEN (OID.ST_CD = '31' OR OID.ST_CD = 'B1')
		                  AND (OID.DLVS_CO_CD IN ('HJ', 'DH', 'HD', 'HT', 'CJ', 'KG', 'EP', 'ER','FA', 'AJ', 'KL', 'YC', 'KR', 'TR', 'KT', 'SD', 'SG', 'ND', 'IN', 'DS', 'CI'))
		                  AND (SYSDATE - (OID.DLV_FSH_DT)) <![CDATA[<]]> 8
		                  AND OID.DLV_FSH_SUBJ_CD = 'V'
		                  AND (CASE
		                         WHEN (TO_NUMBER(TO_CHAR(OID.RELS_FSH_DT, 'YYYYMMDD')) <![CDATA[<]]> '20081211')
		                         THEN '3'
		                         ELSE SUBSTR(OID.DLV_PICK_MTHOD_CD, 0, 1)
		                       END) = '3'
		                 THEN '22'
		                 ELSE OID.ST_CD
		               END                                  AS ORD_ITEM_ST_CD
		             , NVL(OID.RTP_QTY, 0)                  AS RTP_QTY
		             , OID.CHANL_CD                         AS CHANL_CD
		             , DECODE(OOM.ORD_TYP_DTL_CD, 'Sales Order', 'S', 'Return Order', 'R', 'Exchange Sales Order', 'E', 
		               'Exchange Return Order', 'R', 'AS Remove', 'A', 'AS Delivery', 'A', 'AS Not Remove', 'A', 
		               'AS Not Delivery', 'A', 'AS Visit', 'A', 'Virtual Sales', 'S', 'R') AS ORD_TYP_DTL_CD
		             , CASE
		                 WHEN (OID.ST_CD = '22') AND SYSDATE <![CDATA[<]]> ((OID.RELS_FSH_DT + NVL(PCSD.RTP_TERM_DDCNT, 30) + 7) )
		                 THEN 'Y'
		                 WHEN (OID.ST_CD = '31' OR OID.ST_CD = 'B1') AND SYSDATE <![CDATA[<]]> ((OID.DLV_FSH_DT + NVL(PCSD.RTP_TERM_DDCNT, 30) + 1))
		                 THEN 'Y'
		                 ELSE 'N'
		               END AS RTP_EXCH_PSBL_FLG
		             , OID.SUP_CD
		             , NVL(OID.DLVC_STD_AMT, 0) AS DLVC_STD_AMT
		             , OID.DLV_PICK_MTHOD_CD
		             , NVL(SSM.MIM_TYP_CD, '') AS MIM_TYP_CD
		             , NVL(SSM.SUP_NM, '')     AS SUP_NM
		             , SSM.ASIGNR_TELNO_1      AS ASIGNR_TELNO
		             , OID.RFN_TYP_CD
		             , FLOOR( ((NVL(OID.STD_UPRC, 0) - (NVL(OIPD_A01.SUP_GIV_AMT, 0) + NVL(OIPD_A01.GSHS_GIV_AMT, 0)) )) / 10) *
		               10 + NVL(OIPD_A14.GSHS_GIV_AMT, 0)  AS SALE_PRC
		             , NVL(OID.LAST_UPRC, 0)  AS PAY_PRC
		             , OID.ARFN_TIME_CD
		             , PAPM.ATTR_PRD_CD
		             , CASE
		                 WHEN (SELECT COUNT(*)
		                         FROM SRV_SR_M SSM
		                            , SRV_SR_CLS_C SSCC
		                        WHERE SSM.SR_RSN_SML_CLS_CD = SSCC.SR_RSN_CLS_CD(+)
		                          AND SSCC.SR_RSN_CLS_TYP_CD(+) = 'SR'
		                          AND SSM.ORD_ITEM_ID = OID.ORD_ITEM_ID
		                          AND NVL(SSM.SR_PROC_ST_CD, 'Closed') = 'Open'
		                          AND SSM.CUST_NO = #{_c.custNo[0].value}
		                          AND SSCC.OLD_CLS_CD = 'I04') > 0
		                 THEN 'Y'
		                 ELSE 'N'
		               END AS SR_ACP_FLG
		             , NVL(OID.RTP_RE_REQ_PREVNT_CD, 'N') AS RTP_RE_REQ_PREVNT_CD
		             , CASE
		                 WHEN (OID.ST_CD = '22')
		                 THEN TO_CHAR((OID.RELS_FSH_DT + NVL(PCSD.RTP_TERM_DDCNT, 30) + 7), 'yyyymmdd')
		                 WHEN (OID.ST_CD = '31' OR OID.ST_CD = 'B1')
		                 THEN TO_CHAR((OID.DLV_FSH_DT + NVL(PCSD.RTP_TERM_DDCNT, 30) + 1), 'yyyymmdd')
		                 ELSE '00000000'
		               END                                           AS RTP_PSBL_DT
		             , OID.REP_PRD_SUP_PRD_CD
		             , NVL(OID.OBOX_CD, '0')                         AS OBOX_CD
		             , NVL(PPM.EXCH_RTP_CHR_YN, 'N')                 AS EXCH_RTP_CHR_YN
		             , NVL(PPM.RTP_DLVC_CD, '0')                     AS RTP_DLVC_CD
		             , TO_NUMBER(NVL(PPM.RTP_ONEWY_RNDTRP_CD, '0'))  AS RTP_ONEWY_RNDTRP_CD
		             , TO_NUMBER(NVL(PPM.EXCH_ONEWY_RNDTRP_CD, '0')) AS EXCH_ONEWY_RNDTRP_CD
		             , NVL(SSM.CHR_DLVC_CD, '0')                     AS CHR_DLVC_CD
		             , NVL(SSM.APNT_DLVS_PICK_TYP_CD, 'N')           AS APNT_DLVS_PICK_TYP_CD
		             , NVL(SSM.APNT_DLVS_DLVC_CD, '0')               AS APNT_DLVS_DLVC_CD
		             , NVL(PPM.APNT_DLVS_IMPLM_YN, 'N')              AS APNT_DLVS_IMPLM_FLG
		             , TO_CHAR(OID.DLV_FSH_DT, 'YYYYMMDD')           AS DLV_FSH_DT
		             , NVL(PPM.CVS_DLVS_RTP_YN, 'N')                 AS CVS_DLVS_RTP_FLG
		             , TRIM(NVL(OID.OPT_PRD_TYP_CD, '0'))            AS OPT_PRD_TYP_CD
		             , TRIM(NVL(OID.EC_ATTR_SEQ, ''))                AS EC_ATTR_SEQ
		             , NVL(PPM.DITTO_YN, 'N')                        AS DITTO_FLG
		             , NVL(OID.BUNDL_DLV_CD, 'A01')                  AS BUNDL_DLV_CD
		             , NVL(PPM.FRMLES_PRD_TYP_CD, 'N')               AS FRMLES_PRD_TYP_CD
		             , OID.CHAR_CPN_RCVR_TELNO
		             , OID.ORD_ITEM_ID
		             , DECODE(NVL(OOM.ORG_ORD_NO, ''), '', OOM.ORD_NO, OOM.ORG_ORD_NO) AS ORG_ORD_NO
		             , OID.ORG_ORD_ITEM_ID
		          FROM ORD_ORD_M OOM
		             , ORD_ITEM_D OID
		             , ORD_ITEM_PRC_D OIPD_A01
		             , ORD_ITEM_PRC_D OIPD_A14
		             , PRD_PRD_M PPM
		             , SUP_SUP_M SSM
		             , PRD_CLS_M PCM
		             , PRD_CLS_SET_D PCSD
		             , PRD_ATTR_PRD_M PAPM
		         WHERE OOM.CUST_NO        = #{_c.custNo[0].value}
		           AND OOM.ORD_DTM       >= ADD_MONTHS(SYSDATE, - 3)
		           AND OOM.ORD_NO         = OID.ORD_NO
		           AND OOM.ORD_NO         = #{_c.ordNo[0].value}
		           <if test='_c.gubunFlg != null and _c.gubunFlg[0].value == "C"'>
		           AND OID.ORD_ITEM_NO    = #{_c.ordItemNo[0].value}
		           </if>
		           <if test='_c.gubunFlg != null and _c.gubunFlg[0].value == "D"'>
		           AND OID.ORD_ITEM_NO   != #{_c.ordItemNo[0].value}
		           AND OID.RFN_TYP_CD     = #{_c.rfnTypCd[0].value}
		           AND OOM.ORD_TYP_DTL_CD IN ('Sales Order')
		           	<if test='_c.oboxYn[0].value != "Y"'>
		           AND OID.SUP_CD         = #{_c.supCd[0].value}
		           	</if>
		           </if>
		           AND NVL(OID.ORD_QTY, 0) - NVL(OID.RTP_QTY, 0) > 0
		           AND NVL(OID.RTP_RE_REQ_PREVNT_CD, 'N') IN ('N', 'S')
		           AND NVL(OID.EXCH_RTP_WORK_YN, '0') NOT IN( 'Locked')
		           AND OID.ORD_ITEM_ID           = OIPD_A01.ORD_ITEM_ID(+)
		           AND OIPD_A01.ADJST_DTL_CD(+) = 'A01'
		           AND OID.ORD_ITEM_ID           = OIPD_A14.ORD_ITEM_ID(+)
		           AND OIPD_A14.ADJST_DTL_CD(+) = 'A14'
		           AND OID.PRD_CD                = PPM.PRD_CD
		           AND OID.SUP_CD                = SSM.SUP_CD(+)
		           AND SSM.SUP_CD NOT         IN ('1012691', '1012768', '1012769', '1012771')
		           AND OID.LINE_TYP_CD           = '00'
		           AND PPM.PRD_CLS_CD            = PCM.PRD_CLS_CD
		           AND PCM.PRD_CLS_CD            = PCSD.PRD_CLS_CD
		           AND PCSD.CLS_SET_CD           = 'R'
		           AND ( (OOM.CHANL_CD           = 'P'
		                 AND PCSD.CHANL_OR_GRP_CD =
		                     (SELECT CHANL_GRP_CD
		                        FROM PRD_CHANL_MAPPN_D
		                       WHERE CHANL_CD       = 'P'
		                       AND CHANL_GRP_TYP_CD = 'D'
		                       AND ROWNUM           = 1
		                     )
		                 )
		                 OR (OOM.CHANL_CD          != 'P'
		                 AND PCSD.CHANL_OR_GRP_CD !=
		                     (SELECT CHANL_GRP_CD
		                        FROM PRD_CHANL_MAPPN_D
		                       WHERE CHANL_CD       = 'P'
		                       AND CHANL_GRP_TYP_CD = 'D'
		                       AND ROWNUM           = 1
		                     )
		                 )
		               )
		           AND OID.ATTR_PRD_CD = PAPM.ATTR_PRD_CD(+)
		         ORDER BY OOM.ORD_DTM DESC
		       ) X
		 WHERE X.ORD_ITEM_ST_CD IN ('22', '31', 'B1')
		   AND (RFN_TYP_CD != '50' OR RFN_TYP_CD IS NULL)
		   AND X.RTP_EXCH_PSBL_FLG = 'Y'
		   AND X.SR_ACP_FLG != 'Y'
	</select>
	
	<!--
	   	내용 : 단순 사은품 목록 조회
	   	작성자 : 박노정
	   	작성일 : 2013. 11. 14
	   
	   	#{ordItemId} = '5000000025'
	-->
	
	<select id="findSimplGftList" parameterType="criteria" resultMap="simpleGftInfoMap">
		SELECT OID2.ORD_ITEM_ID
		     , OID2.ORD_NO
		     , OID2.ORD_ITEM_NO
		     , OID2.PRD_CD
		     , CASE
		         WHEN OID2.CHANL_CD IN ('P', 'B') AND OID2.LINE_TYP_CD NOT IN ('01', '02', '06')
		         THEN OID2.EXPOS_PRD_NM
		         ELSE OID2.PRD_NM
		       END AS PRD_NM
		     , OID2.ORD_QTY
		     , OID2.ORG_ORD_ITEM_ID
		     , OID2.LINE_TYP_CD
		     , OID2.ST_CD
		     , OID2.OPT_PRD_TYP_CD
		     , OID2.ATTR_GFT_YN
		     , OID2.MULTI_SIMPL_GBN_CD
		     , OIGMD.WTHDRW_YN
		  FROM ORD_ITEM_D OID1
		     , ORD_ITEM_GFT_MAP_D OIGMD
		     , ORD_ITEM_D OID2
		 WHERE OID1.ORD_NO              = OIGMD.ORG_ORD_NO
		   <if test="_c.ordItemId != null and _c.ordItemId[0].value != ''">
		   AND OID1.ORD_ITEM_ID         = #{_c.ordItemId[0].value}
		   </if>
		   <if test="_c.ordNo != null and _c.ordNo[0].value != ''">
		   AND OID1.ORD_NO              = #{_c.ordNo[0].value}
		   </if>
		   AND OID1.ORD_ITEM_ID         = OIGMD.ORG_ORD_ITEM_ID
		   AND OIGMD.GFT_ORD_ITEM_ID    = OID2.ORD_ITEM_ID
		   AND OID2.LINE_TYP_CD        IN ('01', '02')
		   AND OID2.MULTI_SIMPL_GBN_CD  <![CDATA[<>]]> 'M'
		   AND OIGMD.WTHDRW_YN          = 'Y'
	</select>
	
	<!--
	   	내용 : 프로모션 배송상품코드 조회
	   	작성자 : 박노정
	   	작성일 : 2013. 11. 14
	   
	   	#{ordNo} = 500000008
	   	#{gftPrdCd} = '4547749'
	-->

	<select id="findPmoDlvCd" parameterType="criteria" resultType="string">
		SELECT PSGD.ADD_CMPOS_GBN_CD
		  FROM ORD_ORD_M OOM
		     , ORD_ITEM_D OID
		     , ORD_ITEM_GFT_MAP_D OIGMD
		     , PMO_SIMPL_D PSD
		     , PMO_SIMPL_GFT_D PSGD
		 WHERE OOM.ORD_NO         = #{_c.ordNo[0].value}
		   AND PSGD.GFT_PRD_CD    = #{_c.gftPrdCd[0].value}
		   AND OOM.ORD_NO         = OID.ORD_NO
		   AND OID.LINE_TYP_CD   IN ('01', '02')
		   AND OID.ORD_NO         = OIGMD.ORG_ORD_NO
		   AND OID.ORD_ITEM_ID    = OIGMD.GFT_ORD_ITEM_ID
		   AND OIGMD.PMO_NO       = PSD.PMO_NO
		   AND OIGMD.PRD_PMO_SEQ  = PSD.PRD_PMO_SEQ
		   AND OIGMD.PMO_NO       = PSGD.PMO_NO
		   AND OIGMD.PRD_PMO_SEQ  = PSGD.PRD_PMO_SEQ
		   AND PSGD.GFT_PRD_CD    = OID.PRD_CD
	</select>
	
</mapper>