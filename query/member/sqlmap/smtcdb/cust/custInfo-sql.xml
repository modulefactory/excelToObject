<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://img.real.gsenext.com/iceberg.uifactory.static/dtd/mybatis-3-mapper.dtd">
<mapper namespace="iceberg.capi.cust.smtcdb.repository.cust.CustInfoSqlMapRepository">

	<resultMap type="iceberg.capi.cust.model.cust.Cust" id="custInfoMap">
		<result	property="custNo" column="CUST_NO"/>
		<result	property="loginId" column="LOGIN_ID"/>
		<result	property="passwd" column="PASSWD"/>
		<result	property="ecCustNo" column="EC_CUST_NO"/>
		<result	property="custNm" column="CUST_NM"/>
		<result	property="custEmailAddr" column="CUST_EMAIL_ADDR"/>
		<result	property="ssnoPre7" column="SSNO_PRE7"/>
		<result	property="ssnoEcp" column="SSNO_ECP"/>
		<result	property="ecMemTypCd" column="EC_MEM_TYP_CD"/>
		<result	property="custClsCd" column="CUST_CLS_CD"/>
		<result	property="rlnmCertFlg" column="RLNM_CERT_FLG"/>
		<result	property="ipinCustFlg" column="IPIN_CUST_FLG"/>
		<result	property="basktNo" column="BASKT_NO"/>
		<result	property="regDtm" column="REG_DTM"/>
		<result	property="gsnpntCustNo" column="GSNPNT_CUST_NO"/>
		<result	property="empSaleTgtFlg" column="EMP_SALE_TGT_FLG"/>
		<result	property="homeCntryNoCd" column="HOME_CNTRY_NO_CD"/>
		<result	property="homeRegonTelno" column="HOME_REGON_TELNO"/>
		<result	property="homeTxnoTelno" column="HOME_TXNO_TELNO"/>
		<result	property="homeDtlTelno" column="HOME_DTL_TELNO"/>
		<result	property="celphnAdmComCoCd" column="CELPHN_ADM_COM_CO_CD"/>
		<result	property="celphnRegonTelno" column="CELPHN_REGON_TELNO"/>
		<result	property="celphnTxnoTelno" column="CELPHN_TXNO_TELNO"/>
		<result	property="celphnDtlTelno" column="CELPHN_DTL_TELNO"/>
		<result	property="homeRcvrNm" column="HOME_RCVR_NM"/>
		<result	property="homeZipcd" column="HOME_ZIPCD"/>
		<result	property="homeBaseAddr" column="HOME_BASE_ADDR"/>
		<result	property="homeDtlAddr" column="HOME_DTL_ADDR"/>
		<result	property="homeEastnChkRsltCd" column="HOME_EASTN_CHK_RSLT_CD"/>
		<result	property="homeDmSndpGbnCd" column="HOME_DM_SNDP_GBN_CD"/>
		<result	property="ofcRcvrNm" column="OFC_RCVR_NM"/>
		<result	property="ofcZipcd" column="OFC_ZIPCD"/>
		<result	property="ofcBaseAddr" column="OFC_BASE_ADDR"/>
		<result	property="ofcDtlAddr" column="OFC_DTL_ADDR"/>
		<result	property="ofcEastnChkRsltCd" column="OFC_EASTN_CHK_RSLT_CD"/>
		<result	property="ofcDmSndpGbnCd" column="OFC_DM_SNDP_GBN_CD"/>
		<result	property="ipinCiNo" column="IPIN_CI_NO"/>
		<result	property="ecForgnShopTrmsAgreeFlg" column="EC_FORGN_SHOP_TRMS_AGREE_FLG"/>
		<result	property="custEngNm" column="CUST_ENG_NM"/>
		<result	property="addrCntcNo" column="ADDR_CNTC_NO"/>
		<result	property="dcRt" column="DC_RT"/>
		<result	property="ipinDiNo" column="IPIN_DI_NO"/>
		<result	property="gshsMktThdprtInfoProvdFlg" column="GSHS_MKT_THDPRT_INFO_PROVD_FLG"/>
		<result	property="slfCertFlg" column="SLF_CERT_FLG"/> 
	</resultMap>

	<select id="findCust" parameterType="criteria" resultMap="custInfoMap">
        SELECT /* /smtcdb/cust-sql.xml. 2013.10.18 by 김경아 */
                CCM.CUST_NO                                   AS CUST_NO
               ,CCTM.LOGIN_ID                                 AS LOGIN_ID
               ,CCTM.PASSWD                                   AS PASSWD
               ,CCTM.EC_CUST_NO                               AS EC_CUST_NO
               ,CCM.CUST_NM                                   AS CUST_NM
               ,CCM.CUST_EMAIL_ADDR                           AS CUST_EMAIL_ADDR
               ,CCM.SSNO_PRE7                                 AS SSNO_PRE7
               ,CCM.SSNO_ECP                                  AS SSNO_ECP
               ,CCM.EC_MEM_TYP_CD                             AS EC_MEM_TYP_CD
               ,CCM.CUST_CLS_CD                               AS CUST_CLS_CD
               ,NVL(CCM.RLNM_CERT_YN, 'N')                    AS RLNM_CERT_FLG    
               ,NVL(CCM.IPIN_CUST_YN, 'N')                    AS IPIN_CUST_FLG        
               ,CCM.BASKT_NO                                  AS BASKT_NO
               ,TO_CHAR(CCM.REG_DTM, 'yyyymmdd')              AS REG_DTM        
               ,CGCM.GSNPNT_CUST_NO                           AS GSNPNT_CUST_NO
               ,NVL(CCCDRD.EMP_SALE_TGT_YN, 'N')              AS EMP_SALE_TGT_FLG        
               ,CCTD1.CNTRY_NO_CD                             AS HOME_CNTRY_NO_CD       
               ,CCTD1.REGON_TELNO                             AS HOME_REGON_TELNO          
               ,CCTD1.TXNO_TELNO                              AS HOME_TXNO_TELNO           
               ,CCTD1.DTL_TELNO                               AS HOME_DTL_TELNO           
               ,CCTD2.CELPHN_ADM_COM_CO_CD                    AS CELPHN_ADM_COM_CO_CD     
               ,CCTD2.REGON_TELNO                             AS CELPHN_REGON_TELNO      
               ,CCTD2.TXNO_TELNO                              AS CELPHN_TXNO_TELNO        
               ,CCTD2.DTL_TELNO                               AS CELPHN_DTL_TELNO        
               ,CCAD1.RCVR_NM                                 AS HOME_RCVR_NM        
               ,CCAD1.ZIPCD                                   AS HOME_ZIPCD      
               ,CCAD1.BASE_ADDR                               AS HOME_BASE_ADDR      
               ,CCAD1.DTL_ADDR                                AS HOME_DTL_ADDR      
               ,CCAD1.EASTN_CHK_RSLT_CD                       AS HOME_EASTN_CHK_RSLT_CD        
               ,DECODE(CCM.DM_SNDP_GBN_CD, '1', 'Y', 'N')     AS HOME_DM_SNDP_GBN_CD        
               ,CCAD2.RCVR_NM                                 AS OFC_RCVR_NM
               ,CCAD2.ZIPCD                                   AS OFC_ZIPCD   
               ,CCAD2.BASE_ADDR                               AS OFC_BASE_ADDR        
               ,CCAD2.DTL_ADDR                                AS OFC_DTL_ADDR        
               ,CCAD2.EASTN_CHK_RSLT_CD                       AS OFC_EASTN_CHK_RSLT_CD        
               ,DECODE(CCM.DM_SNDP_GBN_CD, '2', 'Y', 'N')     AS OFC_DM_SNDP_GBN_CD        
               ,CCM.IPIN_CI_NO                                AS IPIN_CI_NO
               ,NVL(CCTM.EC_FORGN_SHOP_TRMS_AGREE_YN, 'N')    AS EC_FORGN_SHOP_TRMS_AGREE_FLG        
               ,CCM.CUST_ENG_NM                               AS CUST_ENG_NM
               ,CCAD1.ADDR_CNTC_NO                            AS ADDR_CNTC_NO
               ,NVL(CCCDRD.DC_RT,0)                           AS DC_RT        
               ,CCM.IPIN_DI_NO                                AS IPIN_DI_NO
               ,NVL(CGCM.THDPRT_INFO_AGREE_YN, 'N')           AS GSHS_MKT_THDPRT_INFO_PROVD_FLG        
               ,NVL(CCM.SLF_CERT_YN, 'N')                     AS SLF_CERT_FLG        
         FROM  CST_CUST_M             CCM                     
              ,CST_CUST_ACCNT_M       CCTM
              ,CST_GSNPNT_CUST_M      CGCM
              ,CST_CUST_CLS_DC_RT_D   CCCDRD
              ,CST_CUST_TELNO_D       CCTD1
              ,CST_CUST_TELNO_D       CCTD2
              ,CST_CUST_ADDR_D        CCAD1
              ,CST_CUST_ADDR_D        CCAD2
        WHERE  CCM.CUST_NO                 = CCTM.CUST_NO         
          AND  CCM.CUST_NO                 = CGCM.CUST_NO(+)
          AND  CCM.CUST_CLS_CD             = CCCDRD.CUST_CLS_CD(+)
          AND  CCM.CUST_NO                 = CCTD1.CUST_NO(+)
          AND  CCM.CUST_NO                 = CCTD2.CUST_NO(+)
          AND  CCM.CUST_NO                 = CCAD1.CUST_NO(+)
          AND  CCM.CUST_NO                 = CCAD2.CUST_NO(+)
          <if test="_c.custNo !=null and _c.custNo[0].value != null and  _c.custNo[0].value > 0 " >
          AND  CCM.CUST_NO                 = #{_c.custNo[0].value}
          </if>
          <if test="_c.ipinDiNo !=null and _c.ipinDiNo[0].value != null and !''.equals(_c.ipinDiNo[0].value) " >
          AND  CCM.IPIN_DI_NO              = #{_c.ipinDiNo[0].value} 
          </if> 
          <if test="_c.loginId !=null and _c.loginId[0].value != null and !''.equals(_c.loginId[0].value) " >
          AND  CCTM.LOGIN_ID               = #{_c.loginId[0].value} 
          </if> 
          AND  CCM.CUST_ST_CD              = 'Y'
          AND  CCTM.CUST_ACCNT_GBN_CD      = 'GSEC'
          AND  CCTM.CUST_ACCNT_ST_CD       = 'A'          
          AND  CGCM.GSNPNT_CUST_ST_CD(+)   = '01'          
          AND  SYSDATE BETWEEN CCCDRD.VALID_STR_DTM(+) 
                           AND CCCDRD.VALID_END_DTM(+)         
          AND  CCTD1.TELNO_TYP_CD(+)       = 'HP'
          AND  CCTD1.USE_YN(+)             = 'Y'          
          AND  CCTD2.TELNO_TYP_CD(+)       = 'CP'
          AND  CCTD2.USE_YN(+)             = 'Y'          
          AND  CCAD1.ADDR_USE_YN(+)        = 'Y'
          AND  CCAD1.ADDR_GBN_CD(+)        = '01'          
          AND  CCAD2.ADDR_USE_YN(+)        = 'Y'
          AND  CCAD2.ADDR_GBN_CD(+)        = '02' 
	</select>

</mapper>